import{_ as e,r as o,o as c,a as l,d as n,b as a,w as p,F as u,e as i,f as t}from"./app.7eb989d9.js";const k={},r=n("div",{class:"custom-container info"},[n("p",{class:"custom-container-title"},"\u76F8\u5173\u4FE1\u606F"),n("p",null,"\u6587\u7AE0\u4ECB\u7ECD")],-1),m={class:"table-of-contents"},b=t("Jedis\u8FDE\u63A5\u4EE3\u7801"),d=t("\u7BA1\u9053\u64CD\u4F5C"),g=t("Lua\u811A\u672C"),f=t("\u8BED\u6CD5"),q=t("Jedis\u5E94\u7528"),h=t("\u54E8\u5175\u8BBF\u95EE"),y=t("Spring\u54E8\u5175\u8BBF\u95EE"),v=t("Jedis\u96C6\u7FA4\u64CD\u4F5C"),w=t("Spring\u96C6\u7FA4\u8BBF\u95EE"),j=i(`<hr><h1 id="jedis\u7B80\u5355\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#jedis\u7B80\u5355\u5E94\u7528" aria-hidden="true">#</a> Jedis\u7B80\u5355\u5E94\u7528</h1><h2 id="jedis\u8FDE\u63A5\u4EE3\u7801" tabindex="-1"><a class="header-anchor" href="#jedis\u8FDE\u63A5\u4EE3\u7801" aria-hidden="true">#</a> Jedis\u8FDE\u63A5\u4EE3\u7801</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * \u8FDE\u63A5\u6C60\u914D\u7F6E
 */</span>
<span class="token class-name">JedisPoolConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPoolConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
config<span class="token punctuation">.</span><span class="token function">setMaxTotal</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u6700\u5927\u8FDE\u63A5\u6570</span>
config<span class="token punctuation">.</span><span class="token function">setMaxIdle</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//\u6700\u5927\u7A7A\u95F2\u8FDE\u63A5\u6570</span>
config<span class="token punctuation">.</span><span class="token function">setMinIdle</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//\u6700\u5C0F\u7A7A\u95F2\u8FDE\u63A5\u6570</span>
<span class="token class-name">JedisPool</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPool</span><span class="token punctuation">(</span>config<span class="token punctuation">,</span> <span class="token string">&quot;118.126.82.157&quot;</span><span class="token punctuation">,</span> <span class="token number">6379</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u5EFA\u7ACB\u8FDE\u63A5\u6C60</span>
<span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u83B7\u53D6jedis\u5BF9\u8C61</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;jedis:single&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;test-jedis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//set\u64CD\u4F5C</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;jedis:single&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//get\u64CD\u4F5C</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="\u7BA1\u9053\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u7BA1\u9053\u64CD\u4F5C" aria-hidden="true">#</a> \u7BA1\u9053\u64CD\u4F5C</h2><p><strong>\u7BA1\u9053\u64CD\u4F5C\u4E0D\u662F\u539F\u5B50\u7684</strong>\uFF0C\u5982\u679C\u6709\u62A5\u9519\u4F1A\u8DF3\u8FC7\uFF0C\u7C7B\u4F3C\u4E8E\u961F\u5217\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">Pipeline</span> pipelined <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">pipelined</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pipelined<span class="token punctuation">.</span><span class="token function">incr</span><span class="token punctuation">(</span><span class="token string">&quot;pipeline:incr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    pipelined<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;pipeline:value:&quot;</span> <span class="token operator">+</span> i<span class="token punctuation">,</span> <span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//\u6A21\u62DF\u7BA1\u9053\u62A5\u9519</span>
    pipelined<span class="token punctuation">.</span><span class="token function">setbit</span><span class="token punctuation">(</span><span class="token string">&quot;pipeline:exception:&quot;</span><span class="token operator">+</span>i<span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> returnAll <span class="token operator">=</span> pipelined<span class="token punctuation">.</span><span class="token function">syncAndReturnAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>returnAll<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="lua\u811A\u672C" tabindex="-1"><a class="header-anchor" href="#lua\u811A\u672C" aria-hidden="true">#</a> Lua\u811A\u672C</h2><ul><li><strong>\u539F\u5B50\u64CD\u4F5C</strong>\uFF0C\u6240\u6709\u7684\u64CD\u4F5C\u5305\u88C5\u5728Lua\u811A\u672C\u4E2D\u4E00\u8D77\u6267\u884C\u3002</li><li>\u51CF\u5C11\u7F51\u7EDC\u5F00\u9500\uFF0C\u8DDF\u7BA1\u9053\u4E00\u6837\uFF0C\u591A\u6B21\u64CD\u4F5C\u8FDE\u63A5\u4E00\u6B21\u4E00\u5757\u513F\u6267\u884C\u3002</li><li><strong>\u66FF\u4EE3Redis\u7684\u4E8B\u52A1\u529F\u80FD</strong>\uFF0Credis\u7684\u81EA\u8EAB\u7684\u4E8B\u52A1\u652F\u6301\u4E0D\u597D\uFF0C\u5EFA\u8BAE\u4F7F\u7528Lua\u811A\u672C\u3002</li><li>\u4E0D\u8981\u5728Lua\u811A\u672C\u4E2D\u51FA\u73B0\u6B7B\u5FAA\u73AF\u6216\u8005\u8017\u65F6\u64CD\u4F5C\uFF0C\u4E0D\u7136\u4F1A\u963B\u585ERedis\u3002</li></ul><h3 id="\u8BED\u6CD5" tabindex="-1"><a class="header-anchor" href="#\u8BED\u6CD5" aria-hidden="true">#</a> \u8BED\u6CD5</h3><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># \u8BED\u6CD5\u683C\u5F0F</span>
EVAL script numkeys key <span class="token punctuation">[</span>key <span class="token punctuation">..</span>.<span class="token punctuation">]</span> arg <span class="token punctuation">[</span>arg <span class="token punctuation">..</span>.<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="jedis\u5E94\u7528" tabindex="-1"><a class="header-anchor" href="#jedis\u5E94\u7528" aria-hidden="true">#</a> Jedis\u5E94\u7528</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * Lua\u811A\u672C\u6A21\u62DF\u51CF\u5E93\u5B58\u64CD\u4F5C
 */</span>
jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;lua:product:10016&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;15&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//\u5E93\u5B58\u8BBE\u7F6E\u4E3A15</span>
<span class="token class-name">String</span> script <span class="token operator">=</span> <span class="token string">&quot;local count = redis.call(&#39;get&#39;,KEYS[1])&quot;</span>
        <span class="token operator">+</span> <span class="token string">&quot;  local a = tonumber(count)&quot;</span>
        <span class="token operator">+</span> <span class="token string">&quot;  local b = tonumber(ARGV[1])&quot;</span>
        <span class="token operator">+</span> <span class="token string">&quot;  if a &gt;= b then&quot;</span>
        <span class="token operator">+</span> <span class="token string">&quot;  redis.call(&#39;set&#39;,KEYS[1],a-b)&quot;</span>
        <span class="token comment">//\u6A21\u62DF\u8BED\u6CD5\u62A5\u9519</span>
        <span class="token comment">//+ &quot;bb == 0&quot;</span>
        <span class="token operator">+</span> <span class="token string">&quot;  return 1&quot;</span>
        <span class="token operator">+</span> <span class="token string">&quot;  end&quot;</span>
        <span class="token operator">+</span> <span class="token string">&quot;  return 0&quot;</span><span class="token punctuation">;</span>
<span class="token class-name">Object</span> eval <span class="token operator">=</span> jedis<span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span>script<span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;lua:product:10016&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">&quot;10&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>eval<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="\u54E8\u5175\u8BBF\u95EE" tabindex="-1"><a class="header-anchor" href="#\u54E8\u5175\u8BBF\u95EE" aria-hidden="true">#</a> \u54E8\u5175\u8BBF\u95EE</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JedisSentinelTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token doc-comment comment">/**
         * \u8FDE\u63A5\u6C60\u914D\u7F6E
         */</span>
        <span class="token class-name">JedisPoolConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPoolConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">setMaxTotal</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u6700\u5927\u8FDE\u63A5\u6570</span>
        config<span class="token punctuation">.</span><span class="token function">setMaxIdle</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//\u6700\u5927\u7A7A\u95F2\u8FDE\u63A5\u6570</span>
        config<span class="token punctuation">.</span><span class="token function">setMinIdle</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//\u6700\u5C0F\u7A7A\u95F2\u8FDE\u63A5\u6570</span>
        <span class="token doc-comment comment">/**
         * \u914D\u7F6E\u54E8\u5175\u8282\u70B9
         */</span>
        <span class="token class-name">String</span> masterName <span class="token operator">=</span> <span class="token string">&quot;redis-master-1&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> sentinels <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// sentinels.add(new HostAndPort(&quot;118.126.82.157&quot;,26380).toString());</span>
        <span class="token comment">// sentinels.add(new HostAndPort(&quot;118.126.82.157&quot;,26381).toString());</span>
        <span class="token comment">// sentinels.add(new HostAndPort(&quot;118.126.82.157&quot;,26382).toString());</span>
        sentinels<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;sunqiang.club&quot;</span><span class="token punctuation">,</span><span class="token number">26380</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sentinels<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;sunqiang.club&quot;</span><span class="token punctuation">,</span><span class="token number">26381</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sentinels<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;sunqiang.club&quot;</span><span class="token punctuation">,</span><span class="token number">26382</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JedisSentinelPool</span> pool <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisSentinelPool</span><span class="token punctuation">(</span>masterName<span class="token punctuation">,</span> sentinels<span class="token punctuation">,</span> config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jedis</span> jedis <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            jedis <span class="token operator">=</span> pool<span class="token punctuation">.</span><span class="token function">getResource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;sentinel:jedis&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;test1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedis<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;sentinel:jedis&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token comment">// \u8FD9\u91CC\u4E0D\u662F\u91CA\u653E\uFF0C\u662F\u5C06\u8D44\u6E90\u5F52\u8FD8\u5230pool</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>jedis <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                jedis<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h2 id="spring\u54E8\u5175\u8BBF\u95EE" tabindex="-1"><a class="header-anchor" href="#spring\u54E8\u5175\u8BBF\u95EE" aria-hidden="true">#</a> Spring\u54E8\u5175\u8BBF\u95EE</h2><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">3000</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> admin.redis
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">master</span><span class="token punctuation">:</span> redis<span class="token punctuation">-</span>master<span class="token punctuation">-</span><span class="token number">1</span>
      <span class="token key atrule">nodes</span><span class="token punctuation">:</span> 118.126.82.157<span class="token punctuation">:</span><span class="token number">26380</span><span class="token punctuation">,</span>118.126.82.157<span class="token punctuation">:</span><span class="token number">26381</span><span class="token punctuation">,</span>118.126.82.157<span class="token punctuation">:</span><span class="token number">26382</span>
    <span class="token key atrule">lettuce</span><span class="token punctuation">:</span>
      <span class="token key atrule">pool</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-idle</span><span class="token punctuation">:</span> <span class="token number">50</span>
        <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">10</span>
        <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">100</span>
        <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">3000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">StringRedisTemplate</span> stringRedisTemplate<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/sentinel&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testSentinel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;spring:sentinel&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;test2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;spring:sentinel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stringRedisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token string">&quot;jedis:single&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="jedis\u96C6\u7FA4\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#jedis\u96C6\u7FA4\u64CD\u4F5C" aria-hidden="true">#</a> Jedis\u96C6\u7FA4\u64CD\u4F5C</h2><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JedisClusterTest</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token doc-comment comment">/**
         * \u8FDE\u63A5\u6C60\u914D\u7F6E
         */</span>
        <span class="token class-name">JedisPoolConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisPoolConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">setMaxTotal</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//\u6700\u5927\u8FDE\u63A5\u6570</span>
        config<span class="token punctuation">.</span><span class="token function">setMaxIdle</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//\u6700\u5927\u7A7A\u95F2\u8FDE\u63A5\u6570</span>
        config<span class="token punctuation">.</span><span class="token function">setMinIdle</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>   <span class="token comment">//\u6700\u5C0F\u7A7A\u95F2\u8FDE\u63A5\u6570</span>
        <span class="token doc-comment comment">/**
         * \u96C6\u7FA4\u8282\u70B9\u914D\u7F6E
         */</span>
        <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HostAndPort</span><span class="token punctuation">&gt;</span></span> nodes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        nodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;118.126.82.157&quot;</span><span class="token punctuation">,</span><span class="token number">6380</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        nodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;118.126.82.157&quot;</span><span class="token punctuation">,</span><span class="token number">6381</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        nodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;118.126.82.157&quot;</span><span class="token punctuation">,</span><span class="token number">6382</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        nodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;118.126.82.157&quot;</span><span class="token punctuation">,</span><span class="token number">6383</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        nodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;118.126.82.157&quot;</span><span class="token punctuation">,</span><span class="token number">6384</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        nodes<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HostAndPort</span><span class="token punctuation">(</span><span class="token string">&quot;118.126.82.157&quot;</span><span class="token punctuation">,</span><span class="token number">6385</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * \u96C6\u7FA4\u8FDE\u63A5
         * connectionTimeout:\u8FDE\u63A5\u8D85\u65F6\u65F6\u95F4
         * soTimeout:\u8BFB\u53D6\u6570\u636E\u8D85\u65F6\u65F6\u95F4
         * maxAttempts:\u91CD\u8BD5\u6B21\u6570
         */</span>
        <span class="token class-name">JedisCluster</span> jedisCluster <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JedisCluster</span><span class="token punctuation">(</span>nodes<span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token string">&quot;admin.redis&quot;</span><span class="token punctuation">,</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token doc-comment comment">/**
         * \u6A21\u62DF\u57FA\u672C\u64CD\u4F5C
         */</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedisCluster<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">&quot;jedis:single&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;test1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>jedisCluster<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;jedis:single&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="spring\u96C6\u7FA4\u8BBF\u95EE" tabindex="-1"><a class="header-anchor" href="#spring\u96C6\u7FA4\u8BBF\u95EE" aria-hidden="true">#</a> Spring\u96C6\u7FA4\u8BBF\u95EE</h2><div class="language-yaml ext-yml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">redis</span><span class="token punctuation">:</span>
    <span class="token key atrule">database</span><span class="token punctuation">:</span> <span class="token number">0</span>
    <span class="token key atrule">timeout</span><span class="token punctuation">:</span> <span class="token number">3000</span>
    <span class="token key atrule">password</span><span class="token punctuation">:</span> admin.redis
    <span class="token key atrule">cluster</span><span class="token punctuation">:</span>
      <span class="token key atrule">nodes</span><span class="token punctuation">:</span> 118.126.82.157<span class="token punctuation">:</span><span class="token number">6380</span><span class="token punctuation">,</span>118.126.82.157<span class="token punctuation">:</span><span class="token number">6381</span><span class="token punctuation">,</span>118.126.82.157<span class="token punctuation">:</span><span class="token number">6382</span><span class="token punctuation">,</span>118.126.82.157<span class="token punctuation">:</span><span class="token number">6383</span><span class="token punctuation">,</span>118.126.82.157<span class="token punctuation">:</span><span class="token number">6384</span><span class="token punctuation">,</span>118.126.82.157<span class="token punctuation">:</span><span class="token number">6385</span>
    <span class="token key atrule">lettuce</span><span class="token punctuation">:</span>
      <span class="token key atrule">pool</span><span class="token punctuation">:</span>
        <span class="token key atrule">max-idle</span><span class="token punctuation">:</span> <span class="token number">50</span>
        <span class="token key atrule">min-idle</span><span class="token punctuation">:</span> <span class="token number">10</span>
        <span class="token key atrule">max-active</span><span class="token punctuation">:</span> <span class="token number">100</span>
        <span class="token key atrule">max-wait</span><span class="token punctuation">:</span> <span class="token number">3000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div>`,22);function _(x,S){const s=o("RouterLink");return c(),l(u,null,[r,n("nav",m,[n("ul",null,[n("li",null,[a(s,{to:"#jedis\u8FDE\u63A5\u4EE3\u7801"},{default:p(()=>[b]),_:1})]),n("li",null,[a(s,{to:"#\u7BA1\u9053\u64CD\u4F5C"},{default:p(()=>[d]),_:1})]),n("li",null,[a(s,{to:"#lua\u811A\u672C"},{default:p(()=>[g]),_:1}),n("ul",null,[n("li",null,[a(s,{to:"#\u8BED\u6CD5"},{default:p(()=>[f]),_:1})]),n("li",null,[a(s,{to:"#jedis\u5E94\u7528"},{default:p(()=>[q]),_:1})])])]),n("li",null,[a(s,{to:"#\u54E8\u5175\u8BBF\u95EE"},{default:p(()=>[h]),_:1})]),n("li",null,[a(s,{to:"#spring\u54E8\u5175\u8BBF\u95EE"},{default:p(()=>[y]),_:1})]),n("li",null,[a(s,{to:"#jedis\u96C6\u7FA4\u64CD\u4F5C"},{default:p(()=>[v]),_:1})]),n("li",null,[a(s,{to:"#spring\u96C6\u7FA4\u8BBF\u95EE"},{default:p(()=>[w]),_:1})])])]),j],64)}var A=e(k,[["render",_]]);export{A as default};
