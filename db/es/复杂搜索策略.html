<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.36" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://github.com/noErrorNoBug/docs/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html"><meta property="og:site_name" content="后端技术笔记"><meta property="og:title" content="title"><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><link rel="icon" href="./favicon.ico"><meta name="author" content="noErrorNoBug"><meta name="keywords" content="java,JVM,并发,算法,mysql,redis,mongodb,elasticsearch,spring,springboot,netty,mq,kafka,分布式,微服务,商城,秒杀,数据仓储,网络协议,Docker,Linux"><link rel="manifest" href="/docs/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#F0FFF0"><link rel="apple-touch-icon" href="/icons/icon-192x192.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="white"><link rel="mask-icon" href="/icons/icon-256x256.png" color="#F0FFF0"><meta name="msapplication-TileImage" content="/icons/icon-384x384.png"><meta name="msapplication-TileColor" content="#46bd87"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>title | 后端技术笔记</title><meta name="description" content="noErrorNoBug(sunqiang)的后端技术笔记">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/docs/assets/style.004f05f4.css">
    <link rel="modulepreload" href="/docs/assets/app.7eb989d9.js"><link rel="modulepreload" href="/docs/assets/复杂搜索策略.html.aedf6229.js"><link rel="modulepreload" href="/docs/assets/复杂搜索策略.html.f9963c81.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc sidebar-open"><!--[--><header class="navbar"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><a href="/docs/" class="home-link"><img class="logo light" src="/docs/logo.svg" alt="后端技术笔记"><img class="logo dark light" src="/docs/logo.svg" alt="后端技术笔记"><span class="site-name hide-in-pad">后端技术笔记</span><!--[--><!----><!--]--></a><nav class="nav-links" style=""><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="面试题"><span class="title"><!---->面试题</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/docs/questions/Java%E9%9D%A2%E8%AF%95%E9%A2%98.html" class="nav-link" arialabel="Java面试题"><!---->Java面试题<!----></a></li><li class="dropdown-item"><a href="/docs/questions/%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8%E4%B8%AD%E9%97%B4%E4%BB%B6%E9%9D%A2%E8%AF%95%E9%A2%98.html" class="nav-link" arialabel="数据存储中间件面试题"><!---->数据存储中间件面试题<!----></a></li><li class="dropdown-item"><a href="/docs/questions/%E6%A1%86%E6%9E%B6%E4%B8%AD%E9%97%B4%E4%BB%B6%E9%9D%A2%E8%AF%95%E9%A2%98.html" class="nav-link" arialabel="框架中间件面试题"><!---->框架中间件面试题<!----></a></li><li class="dropdown-item"><a href="/docs/questions/%E5%88%86%E5%B8%83%E5%BC%8F%E5%92%8C%E5%BE%AE%E6%9C%8D%E5%8A%A1%E9%9D%A2%E8%AF%95%E9%A2%98.html" class="nav-link" arialabel="分布式和微服务面试题"><!---->分布式和微服务面试题<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="Java"><span class="title"><!---->Java</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>面向对象|基础</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/java/basic/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%BC%96%E7%A8%8B.html" class="nav-link" arialabel="面向对象特性"><!---->面向对象特性<!----></a></li><li class="dropdown-subitem"><a href="/docs/java/basic/Java%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86.html" class="nav-link" arialabel="Java基础知识"><!---->Java基础知识<!----></a></li><li class="dropdown-subitem"><a href="/docs/java/basic/Java%E6%B3%9B%E5%9E%8B%E6%9C%BA%E5%88%B6.html" class="nav-link" arialabel="Java高级特性"><!---->Java高级特性<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>JAVA 集合框架</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Collection 集合"><!---->Collection 集合<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Map 集合"><!---->Map 集合<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="并发集合框架"><!---->并发集合框架<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>JAVA 并发框架</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="并发理论基础"><!---->并发理论基础<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="多线程基础"><!---->多线程基础<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="关键字详解"><!---->关键字详解<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="集合与并发集合"><!---->集合与并发集合<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="线程池"><!---->线程池<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="CAS原理和原子类"><!---->CAS原理和原子类<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="AQS原理和锁机制"><!---->AQS原理和锁机制<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="并发流程控制"><!---->并发流程控制<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Disruptor框架"><!---->Disruptor框架<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="ThreadLocal"><!---->ThreadLocal<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="并发设计模式"><!---->并发设计模式<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>JAVA IO框架</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="JAVA IO"><!---->JAVA IO<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="JAVA NIO"><!---->JAVA NIO<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>JVM原理</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/java/jvm/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6.html" class="nav-link" arialabel="JVM类加载机制"><!---->JVM类加载机制<!----></a></li><li class="dropdown-subitem"><a href="/docs/java/jvm/%E7%B1%BB%E5%8A%A0%E8%BD%BD%E6%9C%BA%E5%88%B6.html" class="nav-link" arialabel="JVM内存知识"><!---->JVM内存知识<!----></a></li><li class="dropdown-subitem"><a href="/docs/java/jvm/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B.html" class="nav-link" arialabel="JVM垃圾回收原理"><!---->JVM垃圾回收原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/java/jvm/%E5%AF%B9%E8%B1%A1%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.html" class="nav-link" arialabel="JVM调优思路"><!---->JVM调优思路<!----></a></li><li class="dropdown-subitem"><a href="/docs/java/jvm/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6.html" class="nav-link" arialabel="JVM线上调试排查"><!---->JVM线上调试排查<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>JAVA 版本特性</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/java/version/java8/java8%E7%89%B9%E6%80%A7%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB.html" class="nav-link" arialabel="Java8特性"><!---->Java8特性<!----></a></li><li class="dropdown-subitem"><a href="/docs/java/version/java11/java9%E5%88%B0java11%E7%89%B9%E6%80%A7%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB.html" class="nav-link" arialabel="java8升java11特性"><!---->java8升java11特性<!----></a></li><li class="dropdown-subitem"><a href="/docs/java/version/java17/java12%E5%88%B0java17%E7%89%B9%E6%80%A7%E7%9F%A5%E8%AF%86%E4%BD%93%E7%B3%BB.html" class="nav-link" arialabel="java11升java17特性"><!---->java11升java17特性<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="算法"><span class="title"><!---->算法</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>数据结构</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="复杂度析分析"><!---->复杂度析分析<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="线性表相关数据结构"><!---->线性表相关数据结构<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="树相关数据结构"><!---->树相关数据结构<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="堆相关数据结构"><!---->堆相关数据结构<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="图相关数据结构"><!---->图相关数据结构<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>常用算法</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="排序算法"><!---->排序算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="查找算法"><!---->查找算法<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>算法思想</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="动态规划"><!---->动态规划<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分治算法"><!---->分治算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="二分法"><!---->二分法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="搜索算法"><!---->搜索算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="回溯算法"><!---->回溯算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="贪心算法"><!---->贪心算法<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>领域算法实践</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="加密算法"><!---->加密算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="字符串匹配算法"><!---->字符串匹配算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="数据一致性算法"><!---->数据一致性算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="负载均衡算法"><!---->负载均衡算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/algorithm/domain/%E9%99%90%E6%B5%81%E7%AE%97%E6%B3%95.html" class="nav-link" arialabel="限流算法"><!---->限流算法<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="数据处理算法"><!---->数据处理算法<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="数据库"><span class="title"><!---->数据库</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>数据库基础</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="数据库理论"><!---->数据库理论<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="SQL语言"><!---->SQL语言<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>SQL数据库 Mysql</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="索引原理"><!---->索引原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="存储引擎"><!---->存储引擎<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="架构原理"><!---->架构原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="事务机制"><!---->事务机制<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="性能优化"><!---->性能优化<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分库分表和读写分离"><!---->分库分表和读写分离<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Nosql数据库 Redis</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="数据类型和数据结构"><!---->数据类型和数据结构<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="高可用集群原理"><!---->高可用集群原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="数据持久化原理"><!---->数据持久化原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="高性能原理"><!---->高性能原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="性能优化要点"><!---->性能优化要点<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="典型应用实现"><!---->典型应用实现<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Nosql数据库 ElasticSearch</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Elastic Stack生态"><!---->Elastic Stack生态<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="查询和聚合"><!---->查询和聚合<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="复杂搜索策略"><!---->复杂搜索策略<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="聚合匹配"><!---->聚合匹配<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="数据建模"><!---->数据建模<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="核心原理"><!---->核心原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="优化思路"><!---->优化思路<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="框架|中间件"><span class="title"><!---->框架|中间件</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring Framework</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="控制反转(IOC)"><!---->控制反转(IOC)<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="面向切面编程(AOP)"><!---->面向切面编程(AOP)<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="事务机制"><!---->事务机制<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="MVC机制"><!---->MVC机制<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="基于注解配置"><!---->基于注解配置<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="WebFlux"><!---->WebFlux<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring Boot</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="约定大于配置"><!---->约定大于配置<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="自动装配原理"><!---->自动装配原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="组件集成"><!---->组件集成<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>ORM框架</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Mybatis核心原理"><!---->Mybatis核心原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Mybatis-Plus简化开发"><!---->Mybatis-Plus简化开发<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="WEB容器"><span class="title"><!---->WEB容器</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Nginx容器</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="架构及配置"><!---->架构及配置<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="性能调优"><!---->性能调优<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Tomcat容器</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Web请求过程"><!---->Web请求过程<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="启停原理"><!---->启停原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="网络原理"><!---->网络原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="热加载和热部署"><!---->热加载和热部署<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Netty容器</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Netty核心架构"><!---->Netty核心架构<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Netty线程模型实现原理"><!---->Netty线程模型实现原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Netty数据交换实现原理"><!---->Netty数据交换实现原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Netty优化"><!---->Netty优化<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="消息队列"><span class="title"><!---->消息队列</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>RocketMQ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="TODO"><!---->TODO<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Kafka</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Kafka核心原理"><!---->Kafka核心原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="典型应用方案"><!---->典型应用方案<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="调优思路分析"><!---->调优思路分析<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>RabbitMQ</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="架构原理"><!---->架构原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="集群原理"><!---->集群原理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="典型应用方案"><!---->典型应用方案<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="微服务"><span class="title"><!---->微服务</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring Cloud 生态</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/microservice/loadbalance/LoadBalancer%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86.html" class="nav-link" arialabel="LoadBalancer:负载均衡器"><!---->LoadBalancer:负载均衡器<!----></a></li><li class="dropdown-subitem"><a href="/docs/microservice/feign/OpenFeign%E6%9E%B6%E6%9E%84%E5%8E%9F%E7%90%86.html" class="nav-link" arialabel="OpenFeign:函数式调用"><!---->OpenFeign:函数式调用<!----></a></li><li class="dropdown-subitem"><a href="/docs/microservice/gateway/Gateway%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86.html" class="nav-link" arialabel="Gateway:高可用网关API"><!---->Gateway:高可用网关API<!----></a></li><li class="dropdown-subitem"><a href="/docs/microservice/auth/SpringSecurity%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86.html" class="nav-link" arialabel="Security:认证和授权"><!---->Security:认证和授权<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="SkyWalking:链路追踪"><!---->SkyWalking:链路追踪<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="SpringCloud扩展点"><!---->SpringCloud扩展点<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring Cloud Alibaba 生态</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/microservice/register/%E5%9F%BA%E4%BA%8EAP%E6%9E%B6%E6%9E%84%E4%B8%8B%E7%9A%84Nacos%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E5%8E%9F%E7%90%86.html" class="nav-link" arialabel="Nacos:服务注册与发现"><!---->Nacos:服务注册与发现<!----></a></li><li class="dropdown-subitem"><a href="/docs/microservice/config/%E5%9F%BA%E4%BA%8ENacos%E7%9A%84%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%AE%9E%E7%8E%B0.html" class="nav-link" arialabel="Nacos:配置中心"><!---->Nacos:配置中心<!----></a></li><li class="dropdown-subitem"><a href="/docs/microservice/sentinel/%E5%9F%BA%E4%BA%8ESentinel%E5%AE%9E%E7%8E%B0%E6%9C%8D%E5%8A%A1%E9%99%90%E6%B5%81.html" class="nav-link" arialabel="Sentinel:限流和降级"><!---->Sentinel:限流和降级<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Seata:分布式事务"><!---->Seata:分布式事务<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="方法论|系统设计"><span class="title"><!---->方法论|系统设计</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>开发原则</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="代码设计原则"><!---->代码设计原则<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="代码规范和重构"><!---->代码规范和重构<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="开源协议和系统认证"><!---->开源协议和系统认证<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>设计模式范式</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/patterns/build/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F.html" class="nav-link" arialabel="创建型范式"><!---->创建型范式<!----></a></li><li class="dropdown-subitem"><a href="/docs/patterns/construct/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F.html" class="nav-link" arialabel="结构型范式"><!---->结构型范式<!----></a></li><li class="dropdown-subitem"><a href="/docs/patterns/action/%E9%97%A8%E9%9D%A2%E6%A8%A1%E5%BC%8F.html" class="nav-link" arialabel="行为型范式"><!---->行为型范式<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>分布式理论</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/methodology/distribution/%E5%88%86%E5%B8%83%E5%BC%8F%E7%B3%BB%E7%BB%9F%E7%89%B9%E7%82%B9.html" class="nav-link" arialabel="分布式理论和模型"><!---->分布式理论和模型<!----></a></li><li class="dropdown-subitem"><a href="/docs/methodology/transaction/X_OPEN%E4%BA%8B%E5%8A%A1%E6%A8%A1%E5%9E%8B.html" class="nav-link" arialabel="分布式事务理论"><!---->分布式事务理论<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="微服务理论"><!---->微服务理论<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="架构|分布式"><span class="title"><!---->架构|分布式</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>系统架构</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="架构视角及演进"><!---->架构视角及演进<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="架构的模式与核心要素"><!---->架构的模式与核心要素<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="高并发架构要素"><!---->高并发架构要素<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="高可用架构要素"><!---->高可用架构要素<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="高性能架构要素"><!---->高性能架构要素<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>分布式系统设计</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="全局唯一ID"><!---->全局唯一ID<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式锁"><!---->分布式锁<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式事务"><!---->分布式事务<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式缓存"><!---->分布式缓存<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式任务"><!---->分布式任务<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式会话"><!---->分布式会话<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式链路追踪"><!---->分布式链路追踪<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式文件"><!---->分布式文件<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式存储"><!---->分布式存储<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式计算"><!---->分布式计算<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>系统设计案例</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="秒杀系统案例"><!---->秒杀系统案例<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="后台管理系统案例"><!---->后台管理系统案例<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="数据同步案例"><!---->数据同步案例<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="商城架构案例"><!---->商城架构案例<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="轻量单体限流框架案例"><!---->轻量单体限流框架案例<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="轻量消息系统案例"><!---->轻量消息系统案例<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="OSS单点登录案例"><!---->OSS单点登录案例<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="高可用网关案例"><!---->高可用网关案例<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="认证授权服务案例"><!---->认证授权服务案例<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="大数据"><span class="title"><!---->大数据</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>数据同步</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="canal:数据库准实时同步"><!---->canal:数据库准实时同步<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>日志收集</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="ELK日志数据收集"><!---->ELK日志数据收集<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="项目|优化"><span class="title"><!---->项目|优化</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>系统性能优化</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Java编程性能调优"><!---->Java编程性能调优<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="多线程调优"><!---->多线程调优<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="JVM性能检测及调优"><!---->JVM性能检测及调优<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="设计模式调优"><!---->设计模式调优<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="数据库调优"><!---->数据库调优<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="基础设施优化"><!---->基础设施优化<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="系统网络调优"><!---->系统网络调优<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分布式系统优化"><!---->分布式系统优化<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="业务开发优化"><!---->业务开发优化<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>项目重构|项目设计</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="一套分布式高可用架构选型"><!---->一套分布式高可用架构选型<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="商城系统"><!---->商城系统<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="秒杀系统"><!---->秒杀系统<!----></a></li><li class="dropdown-subitem"><a href="/docs/projects/uua/UUA%E8%AE%A4%E8%AF%81%E4%B8%AD%E5%BF%83%E5%AE%9E%E7%8E%B0%E6%A1%88%E4%BE%8B.html" class="nav-link" arialabel="认证授权系统"><!---->认证授权系统<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="日志中心系统"><!---->日志中心系统<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="基于数据库的订阅中心"><!---->基于数据库的订阅中心<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="高可用网关方案"><!---->高可用网关方案<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="单机可插拔限流框架"><!---->单机可插拔限流框架<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="幂等性框架"><!---->幂等性框架<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="基于Flink的实时推荐系统"><!---->基于Flink的实时推荐系统<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" arialabel="工具|部署"><span class="title"><!---->工具|部署</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>开发工具</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="常用类库"><!---->常用类库<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="代码质量保障"><!---->代码质量保障<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="常用表达式"><!---->常用表达式<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="代码安全"><!---->代码安全<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Linux|Shell脚本</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Shell脚本"><!---->Shell脚本<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="文本操作命令"><!---->文本操作命令<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="系统操作命令"><!---->系统操作命令<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="系统管理命令"><!---->系统管理命令<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>网络协议|抓包工具</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Http1.1协议"><!---->Http1.1协议<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="WebSocket协议"><!---->WebSocket协议<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Http2协议"><!---->Http2协议<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="TLS/SSL协议"><!---->TLS/SSL协议<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="TCP协议"><!---->TCP协议<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="UDP协议"><!---->UDP协议<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="IP协议"><!---->IP协议<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Docker容器化</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="容器进程管理"><!---->容器进程管理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="容器内存管理"><!---->容器内存管理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="容器存储管理"><!---->容器存储管理<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>代码管理|依赖管理</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Git常用功能"><!---->Git常用功能<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="分支管理模式"><!---->分支管理模式<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="Maven依赖管理"><!---->Maven依赖管理<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="GitHub常用功能"><!---->GitHub常用功能<!----></a></li><li class="dropdown-subitem"><a href="/docs/guide.html" class="nav-link" arialabel="常用开源工具"><!---->常用开源工具<!----></a></li></ul></li></ul></button></div></div></nav><div class="nav-actions-wrapper"><!--[--><!----><!--]--><div class="nav-item"><!----></div><div class="nav-item"><a class="repo-link" href="https://github.com/noErrorNoBug" target="_blank" rel="noopener noreferrer"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" arialabelledby="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><title id="github" lang="en">github icon</title><g fill="currentColor"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></g></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" arialabelledby="auto" style="display:block;"><title id="auto" lang="en">auto icon</title><g fill="currentColor"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" arialabelledby="dark" style="display:none;"><title id="dark" lang="en">dark icon</title><g fill="currentColor"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></g></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" arialabelledby="light" style="display:none;"><title id="light" lang="en">light icon</title><g fill="currentColor"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></g></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button><!--[--><!----><!--]--></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar hide-icon"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">SQL数据库 Mysql</span><!----></p><!--[--><!--[--><ul class="sidebar-links"><li><!--[--><a href="/docs/db/mysql/sql%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/mysql/%E7%B4%A2%E5%BC%95%E5%8E%9F%E7%90%86.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/mysql/%E7%B4%A2%E5%BC%95%E5%88%86%E6%9E%90%E5%92%8C%E4%BC%98%E5%8C%96.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/mysql/%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E5%92%8C%E9%94%81%E6%9C%BA%E5%88%B6.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/mysql/MVCC%E5%92%8CBufferPool%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/mysql/%E4%B8%BB%E4%BB%8E%E6%9E%B6%E6%9E%84%E5%92%8C%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading"><!----><span class="title">Nosql数据库 Redis</span><!----></p><!--[--><!--[--><ul class="sidebar-links"><li><!--[--><a href="/docs/db/redis/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%91%BD%E4%BB%A4.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E5%BA%95%E5%B1%82%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AE%9E%E7%8E%B0.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E9%AB%98%E6%80%A7%E8%83%BDIO%E6%A8%A1%E5%9E%8B.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E6%95%B0%E6%8D%AE%E6%8C%81%E4%B9%85%E5%8C%96%E5%8E%9F%E7%90%86.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E4%B8%BB%E4%BB%8E%E6%A8%A1%E5%BC%8F%E5%92%8C%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E5%8E%9F%E7%90%86.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E5%93%A8%E5%85%B5%E9%9B%86%E7%BE%A4%E5%8E%9F%E7%90%86.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E5%88%86%E7%89%87%E9%9B%86%E7%BE%A4%E5%8E%9F%E7%90%86.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E5%8D%95%E7%BA%BF%E7%A8%8B%E9%98%BB%E5%A1%9E%E7%82%B9%E5%8F%8A%E4%BC%98%E5%8C%96%E6%96%B9%E6%A1%88.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E5%9F%BA%E4%BA%8ECPU%E7%BB%93%E6%9E%84%E4%BC%98%E5%8C%96.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/Redis%E5%8F%98%E6%85%A2%E4%BC%98%E5%8C%96%E6%80%9D%E8%B7%AF.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E5%86%85%E5%AD%98%E7%A2%8E%E7%89%87%E4%BC%98%E5%8C%96.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E7%BC%93%E5%86%B2%E5%8C%BA%E4%BC%98%E5%8C%96.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E6%97%81%E8%B7%AF%E7%BC%93%E5%AD%98%E5%BA%94%E7%94%A8.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5%E9%80%89%E6%8B%A9.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E5%BC%82%E5%B8%B8%E6%83%85%E5%86%B5%E5%A4%84%E7%90%86.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81%E5%AE%9E%E7%8E%B0.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/%E7%A7%92%E6%9D%80%E5%9C%BA%E6%99%AF%E5%BA%94%E7%94%A8.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/redis/Lua%E8%84%9A%E6%9C%AC%E5%92%8C%E9%9B%86%E6%88%90%E6%A1%86%E6%9E%B6.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--]--><!----><!--]--></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading active"><!----><span class="title">Nosql数据库 ElasticSearch</span><!----></p><!--[--><!--[--><ul class="sidebar-links"><li><!--[--><a href="/docs/db/es/%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C%E5%92%8C%E5%91%BD%E4%BB%A4.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#匹配精度控制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="匹配精度控制"><!---->匹配精度控制<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match底层转换" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="match底层转换"><!---->match底层转换<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#boost权重控制" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="boost权重控制"><!---->boost权重控制<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#best-fields-策略实现" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="best fields 策略实现"><!---->best fields 策略实现<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#基于dis-max实现best-fields策略进行多字段搜索" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="基于dis_max实现best fields策略进行多字段搜索"><!---->基于dis_max实现best fields策略进行多字段搜索<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#基于tie-breaker参数优化dis-max搜索效果" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="基于tie_breaker参数优化dis_max搜索效果"><!---->基于tie_breaker参数优化dis_max搜索效果<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#使用multi-match简化dis-max-tie-breaker" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="使用multi_match简化dis_max + tie_breaker"><!---->使用multi_match简化dis_max + tie_breaker<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#cross-fields-策略实现" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="cross fields 策略实现"><!---->cross fields 策略实现<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#copy-to-组合fields" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="copy_to 组合fields"><!---->copy_to 组合fields<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match-phrase-常用" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="match phrase（常用）"><!---->match phrase（常用）<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match-phrase-原理" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="match_phrase 原理"><!---->match_phrase 原理<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#slop参数" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="slop参数"><!---->slop参数<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match和proximity-search配合平衡召回率和精准度" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="match和proximity search配合平衡召回率和精准度"><!---->match和proximity search配合平衡召回率和精准度<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#前缀搜索-prefix-search" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="前缀搜索 prefix search"><!---->前缀搜索 prefix search<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#通配符搜索" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="通配符搜索"><!---->通配符搜索<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#正则搜索" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="正则搜索"><!---->正则搜索<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#fuzzy模糊搜索" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="fuzzy模糊搜索"><!---->fuzzy模糊搜索<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#搜索推荐" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="搜索推荐"><!---->搜索推荐<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#from和size分页" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="from和size分页"><!---->from和size分页<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#scroll分页" class="router-link-active router-link-exact-active nav-link sidebar-link heading" arialabel="scroll分页"><!---->scroll分页<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/docs/db/es/%E8%81%9A%E5%90%88%E5%8C%B9%E9%85%8D.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/es/%E6%95%B0%E6%8D%AE%E5%BB%BA%E6%A8%A1.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/es/%E6%A0%B8%E5%BF%83%E5%8E%9F%E7%90%86.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/es/%E4%BC%98%E5%8C%96%E6%80%9D%E8%B7%AF.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/es/ElasticSeach%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84%E6%96%B9%E6%A1%88.html" class="nav-link sidebar-link sidebar-page" arialabel="ElasticSeach集群架构方案"><!---->ElasticSeach集群架构方案<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/es/%E9%9B%86%E7%BE%A4%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7ElasticView.html" class="nav-link sidebar-link sidebar-page" arialabel="集群监控工具ElasticView"><!---->集群监控工具ElasticView<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/es/Kinaba%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85.html" class="nav-link sidebar-link sidebar-page" arialabel="Kinaba部署安装"><!---->Kinaba部署安装<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/docs/db/es/%E9%9D%A2%E8%AF%95%E9%A2%98.html" class="nav-link sidebar-link sidebar-page" arialabel="title"><!---->title<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul><!--]--><!----><!--]--></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->title</h1><div class="article-info"><span class="author-info" arialabel="作者🖊" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" arialabelledby="author"><title id="author" lang="en">author icon</title><g fill="currentColor"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></g></svg><span><a class="author-item" href="https://noerrornobug.github.io/docs/" target="_blank" rel="noopener noreferrer">noErrorNoBug(sunqiang)</a></span><span property="author" content="noErrorNoBug(sunqiang)"></span></span><span class="date-info" arialabel="写作日期📅" data-balloon-pos="down" isoriginal="false" pageview="false" color="true"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewbox="0 0 1024 1024" arialabelledby="calendar"><title id="calendar" lang="en">calendar icon</title><g fill="currentColor"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></g></svg><span>2022年3月26日</span><meta property="datePublished" content="2022-03-26T16:52:54.000Z"></span></div><hr></div><div class="toc-place-holder"><aside id="toc-list"><div class="toc-header">此页内容</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#匹配精度控制" class="router-link-active router-link-exact-active toc-link level2">匹配精度控制</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match底层转换" class="router-link-active router-link-exact-active toc-link level2">match底层转换</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#boost权重控制" class="router-link-active router-link-exact-active toc-link level2">boost权重控制</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#best-fields-策略实现" class="router-link-active router-link-exact-active toc-link level2">best fields 策略实现</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#基于dis-max实现best-fields策略进行多字段搜索" class="router-link-active router-link-exact-active toc-link level3">基于dis_max实现best fields策略进行多字段搜索</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#基于tie-breaker参数优化dis-max搜索效果" class="router-link-active router-link-exact-active toc-link level3">基于tie_breaker参数优化dis_max搜索效果</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#使用multi-match简化dis-max-tie-breaker" class="router-link-active router-link-exact-active toc-link level3">使用multi_match简化dis_max + tie_breaker</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#cross-fields-策略实现" class="router-link-active router-link-exact-active toc-link level2">cross fields 策略实现</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#copy-to-组合fields" class="router-link-active router-link-exact-active toc-link level2">copy_to 组合fields</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match-phrase-常用" class="router-link-active router-link-exact-active toc-link level2">match phrase（常用）</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match-phrase-原理" class="router-link-active router-link-exact-active toc-link level3">match_phrase 原理</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#slop参数" class="router-link-active router-link-exact-active toc-link level3">slop参数</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match和proximity-search配合平衡召回率和精准度" class="router-link-active router-link-exact-active toc-link level3">match和proximity search配合平衡召回率和精准度</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#前缀搜索-prefix-search" class="router-link-active router-link-exact-active toc-link level2">前缀搜索 prefix search</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#通配符搜索" class="router-link-active router-link-exact-active toc-link level2">通配符搜索</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#正则搜索" class="router-link-active router-link-exact-active toc-link level2">正则搜索</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#fuzzy模糊搜索" class="router-link-active router-link-exact-active toc-link level2">fuzzy模糊搜索</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#搜索推荐" class="router-link-active router-link-exact-active toc-link level2">搜索推荐</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#from和size分页" class="router-link-active router-link-exact-active toc-link level2">from和size分页</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#scroll分页" class="router-link-active router-link-exact-active toc-link level2">scroll分页</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><!--[--><div class="custom-container info"><p class="custom-container-title">相关信息</p><p>文章介绍</p></div><nav class="table-of-contents"><ul><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#匹配精度控制" class="router-link-active router-link-exact-active">匹配精度控制</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match底层转换" class="router-link-active router-link-exact-active">match底层转换</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#boost权重控制" class="router-link-active router-link-exact-active">boost权重控制</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#best-fields-策略实现" class="router-link-active router-link-exact-active">best fields 策略实现</a><ul><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#基于dis-max实现best-fields策略进行多字段搜索" class="router-link-active router-link-exact-active">基于dis_max实现best fields策略进行多字段搜索</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#基于tie-breaker参数优化dis-max搜索效果" class="router-link-active router-link-exact-active">基于tie_breaker参数优化dis_max搜索效果</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#使用multi-match简化dis-max-tie-breaker" class="router-link-active router-link-exact-active">使用multi_match简化dis_max + tie_breaker</a></li></ul></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#cross-fields-策略实现" class="router-link-active router-link-exact-active">cross fields 策略实现</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#copy-to-组合fields" class="router-link-active router-link-exact-active">copy_to 组合fields</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match-phrase-常用" class="router-link-active router-link-exact-active">match phrase（常用）</a><ul><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match-phrase-原理" class="router-link-active router-link-exact-active">match_phrase 原理</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#slop参数" class="router-link-active router-link-exact-active">slop参数</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#match和proximity-search配合平衡召回率和精准度" class="router-link-active router-link-exact-active">match和proximity search配合平衡召回率和精准度</a></li></ul></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#前缀搜索-prefix-search" class="router-link-active router-link-exact-active">前缀搜索 prefix search</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#通配符搜索" class="router-link-active router-link-exact-active">通配符搜索</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#正则搜索" class="router-link-active router-link-exact-active">正则搜索</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#fuzzy模糊搜索" class="router-link-active router-link-exact-active">fuzzy模糊搜索</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#搜索推荐" class="router-link-active router-link-exact-active">搜索推荐</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#from和size分页" class="router-link-active router-link-exact-active">from和size分页</a></li><li><a aria-current="page" href="/docs/db/es/%E5%A4%8D%E6%9D%82%E6%90%9C%E7%B4%A2%E7%AD%96%E7%95%A5.html#scroll分页" class="router-link-active router-link-exact-active">scroll分页</a></li></ul></nav><hr><h1 id="多条件组合" tabindex="-1"><a class="header-anchor" href="#多条件组合" aria-hidden="true">#</a> 多条件组合</h1><h2 id="匹配精度控制" tabindex="-1"><a class="header-anchor" href="#匹配精度控制" aria-hidden="true">#</a> 匹配精度控制</h2><ul><li><strong>operator</strong>：指定逻辑运算，默认是and，可以指定or表示分词为或关系。</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 使用或语法
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token string">&quot;java developer&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;operator&quot;</span><span class="token operator">:</span><span class="token string">&quot;and&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li><strong>minimum_should_match</strong>：匹配精度，可以使用百分比，表示分词必须有指定的百分比匹配上则符合结果。</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 限定百分比
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token string">&quot;java architect assistant&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;minimum_should_match&quot;</span><span class="token operator">:</span><span class="token string">&quot;68%&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>should + bool：控制匹配精度，可以指定分词的个数。</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 限定分词匹配个数
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;should&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;java&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;developer&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;assistant&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;minimum_should_match&quot;</span><span class="token operator">:</span><span class="token number">2</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="match底层转换" tabindex="-1"><a class="header-anchor" href="#match底层转换" aria-hidden="true">#</a> match底层转换</h2><p>在执行match匹配时，es底层通常对搜索条件会进行转换，来实现最终的结果，<strong>如果条件允许的情况下，应该尽量使用转换后的语法以提高搜索效率</strong>。如下match所示，及转换后的结果：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 转换前，operator=or时替换为should
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;java developer&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 转换后
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;should&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;term&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;java&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;term&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;developer&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

# 转换前，operator=and时转换为must
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token string">&quot;java developer&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;operator&quot;</span><span class="token operator">:</span><span class="token string">&quot;and&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 转换后
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;should&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;term&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;java&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;term&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;developer&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

# 比例转换
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token string">&quot;java architect assistant&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;minimum_should_match&quot;</span><span class="token operator">:</span><span class="token string">&quot;68%&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

# 转换后
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;should&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;java&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;developer&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;assistant&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;minimum_should_match&quot;</span><span class="token operator">:</span><span class="token number">2</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br></div></div><h2 id="boost权重控制" tabindex="-1"><a class="header-anchor" href="#boost权重控制" aria-hidden="true">#</a> boost权重控制</h2><p>如果对于搜索结果需要<strong>按照权重（相关度）排序</strong>，如电商中综合排序，在销量、广告投放量、评价值、库存等排序，广告投放量权重最高、库存权重最低的排序规则，则可以使用boost进行权重控制。boost分值越高则权重越高。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;java&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token property">&quot;should&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
              <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;developer&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;boost&quot;</span><span class="token operator">:</span><span class="token number">1</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
              <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;architect&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;boost&quot;</span><span class="token operator">:</span><span class="token number">3</span>
              <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><h2 id="best-fields-策略实现" tabindex="-1"><a class="header-anchor" href="#best-fields-策略实现" aria-hidden="true">#</a> best fields 策略实现</h2><h3 id="基于dis-max实现best-fields策略进行多字段搜索" tabindex="-1"><a class="header-anchor" href="#基于dis-max实现best-fields策略进行多字段搜索" aria-hidden="true">#</a> 基于dis_max实现best fields策略进行多字段搜索</h3><p>best fields指的是：document中的某一个field，尽可能多的匹配搜索条件。与之相反的是，尽可能多的字段满足匹配条件（most fields策略）。如百度就是用的best fields。</p><p><strong>best fields策略的优点是：精确匹配的数据可以尽可能的排列在最前端，而且可以通过minimum_should_match去除长尾数据，避免长尾数据字段对排序结果产生影响。</strong>（长尾数据指的是：我们想要匹配4个关键词，但是很多文档只匹配1个也显示出来了，这些文档显然不是我们想要的）。</p><p>best fields策略的缺点是：相对排序不均匀。</p><p>dis_max语法：直接获取搜索的多条件中，单条件query**相关度分数（_s<strong><strong>c</strong></strong>o<strong><strong>r</strong></strong>e）**最高的数据，以这个数据做相关度排序，比如下面语句，会根据name字段和remark字段，看哪个_score分数高，就会按照哪个排序。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dis_max&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;queries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rod&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java developer&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="基于tie-breaker参数优化dis-max搜索效果" tabindex="-1"><a class="header-anchor" href="#基于tie-breaker参数优化dis-max搜索效果" aria-hidden="true">#</a> 基于tie_breaker参数优化dis_max搜索效果</h3><p>dis_max是将多个搜索条件中query条件中相关度分数最高的用于结果排序，忽略其他query分数，在某些情况下，可能还需要其他query条件的相关度介入最终结果排序，这个时候可以使用tie_breaker参数优化dis_max。</p><p>tie_breaker参数的含义是：将其他query条件的相关度分数乘以参数值，再参与到结果排序中。如果不指定这个参数，默认为0，其他的query条件的相关度也就被忽略。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dis_max&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;queries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rod&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java developer&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;tie_breaker&quot;</span><span class="token operator">:</span><span class="token number">0.5</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="使用multi-match简化dis-max-tie-breaker" tabindex="-1"><a class="header-anchor" href="#使用multi-match简化dis-max-tie-breaker" aria-hidden="true">#</a> 使用multi_match简化dis_max + tie_breaker</h3><p>es中可以达到相同效果的语法有多重，multi_match可以大幅度简化dis_max + tie_breaker来实现best fields策略。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 不使用 multi_match
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;dis_max&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;queries&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rod&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
              <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java developer&quot;</span><span class="token punctuation">,</span>
              <span class="token property">&quot;boost&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
              <span class="token property">&quot;minimum_should_match&quot;</span><span class="token operator">:</span> <span class="token number">2</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;tie_breaker&quot;</span><span class="token operator">:</span> <span class="token number">0.5</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

# 使用 multi_match<span class="token punctuation">,</span>其中type常用的有best_fields和most_fields。^n代表权重， 相当于<span class="token property">&quot;boost&quot;</span><span class="token operator">:</span>n。 
GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;multi_match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token string">&quot;rod java developer&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;remark^2&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;best_fields&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;tie_breaker&quot;</span><span class="token operator">:</span><span class="token number">0.5</span><span class="token punctuation">,</span>
      <span class="token property">&quot;minimum_should_match&quot;</span><span class="token operator">:</span><span class="token string">&quot;50%&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h2 id="cross-fields-策略实现" tabindex="-1"><a class="header-anchor" href="#cross-fields-策略实现" aria-hidden="true">#</a> cross fields 策略实现</h2><p>cross fields策略：一个唯一的标识，分布在多个fields中，使用这种唯一表示搜索数据就是cross fields 策略。比如人名分为姓和名，地址分为国家、省、市、区县、街道。那么使用人名或者地址搜索就是cross fields，类似于联合主键。使用这种策略一般都是通过most fields策略实现。</p><p>使用cross fields搜索，都会携带一个operator参数，用来标记多个字段的匹配条件。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /es_db/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;multi_match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token string">&quot;java developer&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;remark&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;cross_fields&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;operator&quot;</span><span class="token operator">:</span> <span class="token string">&quot;and&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>在使用 most fields 和 cross fields搜索时，由于不能使用 minimum_should_match进行去除长尾数据，因此涉及到精确搜索的排序问题。在使用most fields策略和best fields策略时，都有不同的优缺点，在实际项目开发中，一般都推荐使用best fields进行搜索。</strong></p><h2 id="copy-to-组合fields" tabindex="-1"><a class="header-anchor" href="#copy-to-组合fields" aria-hidden="true">#</a> copy_to 组合fields</h2><p>有以下场景，需要在电商项目中搜索手机，那么需要在商品名称、商品卖点、商品类型、商品描述哪个字段中进行搜索呢？显然使用_all进行全字段的搜索也是不行的，因为全字段还包含图片、价格等一系列不相关的字段。</p><p><strong>copy_to：将指定的多个字段，复制到一个字段中，实现一个字段的组合搜索。同时 copy_to 还能解决 cross field 策略的问题。在项目中也常用于解决搜索条件默认字段的问题</strong>。</p><p>使用copy_to语法，需要在定义index的时候手动指定静态mapping映射策略。</p><p>下面的例子，provice、city、street字段会在PUT的时候自动复制到adress字段中，不需要手动维护，搜索的时候可以直接在adress条件中做匹配。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 示例数据
<span class="token punctuation">{</span>
  <span class="token property">&quot;category_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;手机&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;product_name&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;一加6T手机&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;price&quot;</span> <span class="token operator">:</span> <span class="token number">568800</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sell_point&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;国产最好的Android手机&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;8G+128G&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;256G可扩展&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;color&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;红色&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;keyword&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;手机 一加6T手机 国产最好的Android手机&quot;</span>
<span class="token punctuation">}</span>

# copy_to 语法
PUT /es_db/_mapping
<span class="token punctuation">{</span>
  <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;provice&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;copy_to&quot;</span><span class="token operator">:</span><span class="token string">&quot;address_a&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;city&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;copy_to&quot;</span><span class="token operator">:</span><span class="token string">&quot;address_a&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;street&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;copy_to&quot;</span><span class="token operator">:</span><span class="token string">&quot;address_a&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token property">&quot;address_a&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span><span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;standard&quot;</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h1 id="近似匹配" tabindex="-1"><a class="header-anchor" href="#近似匹配" aria-hidden="true">#</a> 近似匹配</h1><h2 id="match-phrase-常用" tabindex="-1"><a class="header-anchor" href="#match-phrase-常用" aria-hidden="true">#</a> match phrase（常用）</h2><h3 id="match-phrase-原理" tabindex="-1"><a class="header-anchor" href="#match-phrase-原理" aria-hidden="true">#</a> match_phrase 原理</h3><p>短语搜索，不进行分词，搜索条件不可分割。通过如下语法可以实现短语搜索：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET _search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token string">&quot;java assistant&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>使用match_phrase进行短语检索时，同样也是如match一样，倒排索引时，首先使用_analyze进行分词，分词的同时由于还会保存一个position，也就是分词索引的下标。如果分词都属于同一个field，那么判断position是否连续，如果连续则匹配成功，如果不连续匹配失败。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 分词语法
GET _analyze
<span class="token punctuation">{</span>
  <span class="token property">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;hello world,java spark&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;standard&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="slop参数" tabindex="-1"><a class="header-anchor" href="#slop参数" aria-hidden="true">#</a> slop参数</h3><p>slop参数可以设置match_phrase搜索时，短语分词position可以向后移动的位数，如下所示，如果设置slop=3，那么分词position间隔3个位置都是被允许的：</p><table><thead><tr><th style="text-align:left;"><strong>match_phrase：</strong></th><th style="text-align:left;">hello world</th><th style="text-align:left;"></th><th style="text-align:left;"></th><th style="text-align:left;"></th></tr></thead><tbody><tr><td style="text-align:left;"><strong>下标：</strong></td><td style="text-align:left;">0</td><td style="text-align:left;">1</td><td style="text-align:left;">2</td><td style="text-align:left;">3</td></tr><tr><td style="text-align:left;"><strong>移动1</strong></td><td style="text-align:left;">hello</td><td style="text-align:left;">world</td><td style="text-align:left;"></td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><strong>移动2</strong></td><td style="text-align:left;">hello</td><td style="text-align:left;">you</td><td style="text-align:left;">world</td><td style="text-align:left;"></td></tr><tr><td style="text-align:left;"><strong>移动3</strong></td><td style="text-align:left;">hello</td><td style="text-align:left;">you</td><td style="text-align:left;">fuck</td><td style="text-align:left;">world</td></tr></tbody></table><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET _search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;remark&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java assistant&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;slop&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="match和proximity-search配合平衡召回率和精准度" tabindex="-1"><a class="header-anchor" href="#match和proximity-search配合平衡召回率和精准度" aria-hidden="true">#</a> match和proximity search配合平衡召回率和精准度</h3><ul><li>召回率：搜索结果呈现的比率，召回率越高搜索返回的结果越多。</li><li>精准度：搜索结果的准确率，召回率一般情况下与精准度成反比。 在实际应用中，如果只使用match_phrase进行proximity search的话，会导致召回率过低；但是大范围只使用match就会导致准确率下降。通常两者结合使用。</li></ul><p>如下所示，<strong>使用 bool 组合条件，对于<strong><strong>必须</strong></strong>的条件使用must和match进行分词搜索；使用should和match_ph<strong><strong>r</strong></strong>a<strong><strong>s</strong></strong>e提高搜索<strong><strong>词组</strong></strong>的得分</strong>。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 结合使用match和match_phrase
GET /test_a/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token property">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;f&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java spark&quot;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">&quot;should&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;match_phrase&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;f&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;query&quot;</span><span class="token operator">:</span> <span class="token string">&quot;java spark&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;slop&quot;</span><span class="token operator">:</span> <span class="token number">50</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 数据准备
POST /test_a/_doc/<span class="token number">3</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;f&quot;</span><span class="token operator">:</span><span class="token string">&quot;hello,java is very good,spark is also very good&quot;</span>
<span class="token punctuation">}</span>
POST /test_a/_doc/<span class="token number">4</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;f&quot;</span><span class="token operator">:</span><span class="token string">&quot;java and spark,development language&quot;</span>
<span class="token punctuation">}</span>
POST /test_a/_doc/<span class="token number">5</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;f&quot;</span><span class="token operator">:</span><span class="token string">&quot;Java Spark is a fast and general‐purpose cluster computing system.I t provides high‐level APIs in Java, Scala, Python and R, and an optimized engi ne that supports general execution graphs.&quot;</span>
<span class="token punctuation">}</span>
POST /test_a/_doc/<span class="token number">6</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;f&quot;</span><span class="token operator">:</span><span class="token string">&quot;java spark and,development language&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><h2 id="前缀搜索-prefix-search" tabindex="-1"><a class="header-anchor" href="#前缀搜索-prefix-search" aria-hidden="true">#</a> 前缀搜索 prefix search</h2><p>前缀搜索prefix search<strong>只针对keyword类型<strong><strong>的</strong></strong>字段</strong>，也就是只能针对<strong>不<strong><strong>分词</strong></strong>的字段，而且keyword大小写敏感</strong>。前缀搜索效率低，<strong>不计算相关度分数</strong>。前缀搜索需要扫描完整的索引内容，效率较低，并且<strong>不建议****使用短前缀</strong>。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /test_a/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;f.keyword&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;J&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="通配符搜索" tabindex="-1"><a class="header-anchor" href="#通配符搜索" aria-hidden="true">#</a> 通配符搜索</h2><p>es的通配符和java的不太一样，<strong>通配符支持倒排索引</strong>，也支持keyword。需要扫描完整索引，效率也比较低，不建议使用</p><ul><li>?：一个字符</li><li>*：任意个字符</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /test_a/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;wildcard&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;f.keyword&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;?e*o*&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="正则搜索" tabindex="-1"><a class="header-anchor" href="#正则搜索" aria-hidden="true">#</a> 正则搜索</h2><p>正则索引也是需要扫描完整索引，效率比较低，也不建议使用。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /test_a/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;regexp&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;f.keyword&quot;</span><span class="token operator">:</span><span class="token string">&quot;[A‐z].+&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="fuzzy模糊搜索" tabindex="-1"><a class="header-anchor" href="#fuzzy模糊搜索" aria-hidden="true">#</a> fuzzy模糊搜索</h2><p>fuzzy模糊搜索技术是<strong>解决拼写错误</strong>这种情况的。其中fuzziness的value值代表搜索的输入最多可以错误多少个字母。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /test_a/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;fuzzy&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;f&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;value&quot;</span><span class="token operator">:</span><span class="token string">&quot;word&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;fuzziness&quot;</span><span class="token operator">:</span><span class="token number">2</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="搜索推荐" tabindex="-1"><a class="header-anchor" href="#搜索推荐" aria-hidden="true">#</a> 搜索推荐</h2><p>类似于百度搜索，<strong>输入<strong><strong>某个</strong></strong>词进行关联提示</strong>。原理与match_phrase类似，首先使用match对已经输入的分词进行term，然后在指定的slop移动范围内，进行前缀匹配（只有最后一个term的分词执行前缀匹配）。max_expansions用于指定最多匹配多少个单词，超过这个数量就不再匹配了。</p><p>效率比较低，如果一定要使用的话，一定配合max_expansions。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /test_a/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match_phrase_prefix&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;f&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token string">&quot;java s&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;slop&quot;</span><span class="token operator">:</span><span class="token number">10</span><span class="token punctuation">,</span>
        <span class="token property">&quot;max_expansions&quot;</span><span class="token operator">:</span><span class="token number">10</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h1 id="分页查询" tabindex="-1"><a class="header-anchor" href="#分页查询" aria-hidden="true">#</a> 分页查询</h1><h2 id="from和size分页" tabindex="-1"><a class="header-anchor" href="#from和size分页" aria-hidden="true">#</a> from和size分页</h2><ul><li>from：指定从第多少条数据开始查</li><li>size：指定每页多少数据</li><li>查询数据量在1w-5w左右比较ok，大数据量下不太行，而且es不允许使用这种方式查询1w条以后的数据</li></ul><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>POST /es_db/_doc/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;from&quot;</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;match&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;address&quot;</span><span class="token operator">:</span><span class="token string">&quot;广州天河&quot;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="scroll分页" tabindex="-1"><a class="header-anchor" href="#scroll分页" aria-hidden="true">#</a> scroll分页</h2><p>在进行大量分页时，每次分页都需要将要查询的数据进行重新排序，这样非常浪费性能。scroll是将要用的数据一次性排好，然后分批取出，<strong>scroll之后，排序<strong><strong>的</strong></strong>数据会<strong><strong>保存一定</strong></strong>的<strong><strong>时间</strong></strong>，后续的查询都是从快照中取出</strong>。<strong>第一次查询后，会产生一个scroll_id，这个<strong><strong>就是查询</strong></strong>的<strong><strong>快照号</strong></strong>，后续<strong><strong>的</strong></strong>查询需要基于此号进行</strong>。</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 让排序时间保持1min
GET /es_db/_search?scroll=1m 
<span class="token punctuation">{</span>
  <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;multi_match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;query&quot;</span><span class="token operator">:</span><span class="token string">&quot;广州长沙张三&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">&quot;address&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span> 
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token property">&quot;size&quot;</span><span class="token operator">:</span><span class="token number">100</span>
<span class="token punctuation">}</span>

# <span class="token property">&quot;_scroll_id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAAAZEWY2VQZXBia1JTVkdhTWkwSl9GaUYtQQ==&quot;</span> 

# 第二次直接使用scroll id
GET _search/scroll?scroll=1m
<span class="token punctuation">{</span>
  <span class="token property">&quot;scroll_id&quot;</span><span class="token operator">:</span><span class="token string">&quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAAAZoWY2VQZXBia1JTVkdhTWkwSl9GaUYtQQ==&quot;</span> 
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h1 id="建议搜索" tabindex="-1"><a class="header-anchor" href="#建议搜索" aria-hidden="true">#</a> 建议搜索</h1><p>建议搜索指的是类似于百度那样的联想提示功能，es实现建议搜索的性能非常的高，其构建的不是倒排索引，也不是正排索引，就是<strong>纯粹进行前缀搜索的一种特殊数据结构</strong>，<strong>并且<strong><strong>全部放在</strong></strong>内存中</strong>，使用<strong>建议搜索（suggest search）做联想提示性能很好</strong>。</p><p>要使用建议搜索，需要在定义index时，指定mapping并且开启suggest：</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code># 开启建议搜索
PUT /movie
<span class="token punctuation">{</span>
  <span class="token property">&quot;mappings&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;title&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;fields&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
          <span class="token property">&quot;suggest&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;completion&quot;</span><span class="token punctuation">,</span> 
            <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span> 
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token property">&quot;content&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;type&quot;</span><span class="token operator">:</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span> 
        <span class="token property">&quot;analyzer&quot;</span><span class="token operator">:</span><span class="token string">&quot;ik_max_word&quot;</span> 
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
# 数据准备
PUT /movie/_doc/<span class="token number">1</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;西游记电影系列&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;西游记之月光宝盒将与2021年进行......&quot;</span>
<span class="token punctuation">}</span>

PUT /movie/_doc/<span class="token number">2</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;西游记文学系列&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;某知名网络小说作家已经完成了大话西游同名小说的出版&quot;</span>
<span class="token punctuation">}</span>

PUT /movie/_doc/<span class="token number">3</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;title&quot;</span><span class="token operator">:</span><span class="token string">&quot;西游记之大话西游手游&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;content&quot;</span><span class="token operator">:</span><span class="token string">&quot;网易游戏近日出品了大话西游经典IP的手游，正在火爆内测中&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><p>建议搜索在实际执行搜索时，也需要用其特殊的语法</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code>GET /movie/_search
<span class="token punctuation">{</span>
  <span class="token property">&quot;suggest&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">&quot;my‐suggest&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
      <span class="token property">&quot;prefix&quot;</span><span class="token operator">:</span><span class="token string">&quot;西游记&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;completion&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
        <span class="token property">&quot;field&quot;</span><span class="token operator">:</span><span class="token string">&quot;title.suggest&quot;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><!--]--></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/noErrorNoBug/docs/edit/master/docs/db/es/复杂搜索策略.md" rel="noopener noreferrer" target="_blank" arialabel="编辑此页" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" arialabelledby="edit"><title id="edit" lang="en">edit icon</title><g fill="currentColor"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></g></svg><!--]-->编辑此页<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">上次编辑于: </span><span class="info">2022/3/30 12:03:25</span></div><div class="meta-item contributors"><span class="label">贡献者: </span><!--[--><!--[--><span class="contributor" title="email: 749922109@qq.com">sunqiang</span><!--]--><!--]--></div></footer><nav class="page-nav"><a href="/docs/README.md" class="nav-link prev" arialabel="回到首页"><div class="hint"><span class="arrow left"></span>上一页</div><div class="link"><!---->回到首页</div></a><a href="/docs/README.md" class="nav-link next" arialabel="回到首页"><div class="hint">下一页<span class="arrow right"></span></div><div class="link">回到首页<!----></div></a></nav><div class="giscus-wrapper" style="display:none;"><!----></div><!----></main><!--]--><footer class="footer-wrapper"><div class="footer">Apache License 2.0 | Copyright © 2018-present noErrorNoBug(sunqiang)</div><!----></footer></div><!--]--><!----><!--[--><!-- Root element of PhotoSwipe. Must have class pswp. --><div class="pswp" tabindex="-1" role="dialog" aria-hidden="true"><!-- Background of PhotoSwipe. 
    It’s a separate element, as animating opacity is faster than rgba().--><div class="pswp__bg"></div><!-- Slides wrapper with overflow:hidden. --><div class="pswp__scroll-wrap"><!-- Container that holds slides. PhotoSwipe keeps only 3 slides in DOM to save memory. --><div class="pswp__container"><!-- don’t modify these 3 pswp__item elements, data is added later on --><div class="pswp__item"></div><div class="pswp__item"></div><div class="pswp__item"></div></div><!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. --><div class="pswp__ui pswp__ui--hidden"><div class="pswp__top-bar"><!--  Controls are self-explanatory. Order can be changed. --><div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="关闭"></button><button class="pswp__button pswp__button--share" title="分享"></button><button class="pswp__button pswp__button--fs" title="切换全屏"></button><button class="pswp__button pswp__button--zoom" title="缩放"></button><!-- Preloader demo https://codepen.io/dimsemenov/pen/yyBWoR --><!-- element will get class pswp__preloader--active when preloader is running --><div class="pswp__preloader"><div class="pswp__preloader__icn"><div class="pswp__preloader__cut"><div class="pswp__preloader__donut"></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class="pswp__share-tooltip"></div></div><button class="pswp__button pswp__button--arrow--left" title="上一个 (左箭头)"></button><button class="pswp__button pswp__button--arrow--right" title="下一个 (右箭头)"></button><div class="pswp__caption"><div class="pswp__caption__center"></div></div></div></div></div><!--]--><!----><div id="pwa-install"><!----><div id="install-modal-wrapper" style="display:none;"><div class="background"></div><div class="install-modal"><div class="header"><button class="close-button" aria-label="关闭"><svg xmlns="http://www.w3.org/2000/svg" class="icon close-icon" viewbox="0 0 1024 1024" arialabelledby="close"><title id="close" lang="en">close icon</title><g fill="currentColor"><path d="M589.654 511.965 1007.212 84.22a49.777 49.777 0 0 0-.73-70.02 49.046 49.046 0 0 0-69.687.665L519.967 441.946 85.882 14.2a49.08 49.08 0 0 0-69.687.664 49.777 49.777 0 0 0 .664 70.019l433.454 427.082L16.859 939.048a49.777 49.777 0 0 0-.664 70.019 49.013 49.013 0 0 0 69.687.663l434.085-427.746 416.828 427.083A49.013 49.013 0 0 0 972.037 1024a48.416 48.416 0 0 0 34.512-14.27 49.777 49.777 0 0 0 .73-70.019z"></path></g></svg></button><div class="logo"><!--v-if--><div class="title"><h1></h1><p class="desc">该应用可以安装在你的 PC 或移动设备上。这将使该 Web 应用程序外观和行为与其他应用程序相同。它将在出现在应用程序列表中，并可以固定到主屏幕，开始菜单或任务栏。此 Web 应用程序还将能够与其他应用程序和你的操作系统安全地进行交互。</p></div></div></div><div class="content"><div class="highlight"><!--v-if--><!--v-if--></div><div class="description"><h3>详情</h3><p></p></div></div><div class="button-wrapper"><button class="install-button">安装 <span></span></button><button class="cancel-button">取消</button></div></div></div></div><!--]--></div>
    <script type="module" src="/docs/assets/app.7eb989d9.js" defer></script>
  </body>
</html>
