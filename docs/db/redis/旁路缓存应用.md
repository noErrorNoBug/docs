---
title: title
prev:
  text: 回到首页
  link: /README.md
next:
  text: 回到首页
  link: /README.md
---
::: info
文章介绍
:::
[[toc]]

***
缓存有两个特点：第一，缓存的速度快于一般的存储；第二，缓存的容量小于一般存储的容量，需要有淘汰策略。

# Redis处理缓存的两种情况

* **缓存命中**：Redis中有响应的数据，直接读取Redis数据，速度非常快。
* **缓存缺失**：Redis中没有响应的数据，需要从后端数据库读取，为了让以后的数据不缺失，需要将后端数据库的数据写入Redis中，这个动作叫缓存更新。
使用Redis时，基于以上两种情况，实际我们就进行**三个操作**：

* 缓存命中时，读取缓存数据。
* 缓存缺失时，读取后端数据库数据。
* 缓存缺失时，同时还需要做缓存更新。
# 旁路缓存

Redis是个独立的系统，**读取缓存、读取数据库和更新数据库操作都需要在应用程序中完成，因此又把Redis称为旁路缓存**。

使用Redis作为旁路缓存时，需要增加三部分代码：

* 读取缓存时，显式调用Redis的GET方法
* 缓存缺失了，应该与数据库连接，并且从数据库中读取数据
* 当缓存缺失需要更新缓存时，显式调用Redis的set方法
缺点：操作复杂

优点：Redis作为独立的系统，可以扩容和单独的性能优化

# 缓存类型

按照Redis缓存是否接受写请求，分为只读缓存和读写缓存。

* 如果写请求很多，需要对写请求加速，使用读写缓存
* 如果写请求很少，使用只读缓存
## 只读缓存

当Redis做只读缓存时，会先调用Redis的GET接口，查询数据是否存在。**所有的写操作都直接操作后端数据库，在数据库中增删改**。对于删除来说，**如果Redis中已经缓存了数据，那么应该删除缓存数据（增删改都删除）**。

当再次操作缓存的读操作时，此时就是缓存缺失的状态，在查询数据库的同时，进行缓存更新操作。

只读缓存的好处是，所有的增删改操作都发生在数据库，可靠性较高，对于需要高稳定性的数据、图片、短视频等只读的数据时是一种不错的选择，同时Redis中只保留热点数据。

缺点是缓存确实造成的首次访问延时大。

## 读写缓存

读写缓存因为写操作也发生在Redis中，数据的稳定性差一些，因此也有两种方案：同步直写和异步回写两种方式。

### 同步直写

同步直写可以有效保证数据可靠性，写请求发送给redis的同时，也会发送给数据库，两方都写入数据，当两方都写入完成后才返回成功给客户端。但是这样访问延迟比较大。

### 异步回写

异步回写优先写给Redis，当数据从Redis中淘汰出来时，再回写给数据库。

