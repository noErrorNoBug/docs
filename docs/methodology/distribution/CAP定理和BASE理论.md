---
title: CAP定理和BASE理论
prev:
  text: 原型模式
  link: /patterns/action/原型模式.md
next:
  text: X_OPEN事务模型
  link: /methodology/transaction/X_OPEN事务模型.md
---
::: info
&#8195;&#8195;CAP定理和Base理论是分布式架构的两个基础理论，以此衍生出多种算法和协议来保证分布式系统的稳定运行。
:::
[[toc]]

***

## CAP定理

&#8195;&#8195;CAP定理简单来说指的是**分布式系统中不可能同时满足数据一致性（C）、可用性（A）和分区容错性（P）这三个基础的需求，最多满足其中的两个**。

* **数据一致性（C）**：数据在多个副本中保持强一致。
* **可用性（A）**：系统对外提供的服务必须一直处于可用状态，任何故障下，客户端都能在合理的时间内获得服务端的非错误响应。
* **分区容错性（P）**：任何网络分区故障，系统仍然能够正常对外提供服务。

&#8195;&#8195;**CAP定理证明，分布式系统中，要么满足CP、要么满足AP，不可能实现CAP或者CA**。原因是网络通信并不可靠，如网络延迟、网络异常都可能导致系统故障，所以分区容错性（P）是必然的。

* AP：放弃数据强一致性，实现最终一致性。这是解决分布式系统数据一致性最多的选择，如Nacos的AP架构、Eureka的AP架构和Redis集群。
* CP：放弃高可用，实现强一致性，如Zookeeper集群、Nacos的CP架构。2CP和3CP都采用的这种方案，导致的问题是用户的一个操作可能的等待时间很长。
 
## BASE理论

&#8195;&#8195;**BASE是从CAP中一致性和可用性不可兼得而衍生出来的一种理论思想。BASE理论的思想是通过牺牲分布式系统的数据强一致性来获得高可用**。有以下三个特性：

* 基本可用（BA）：分布式系统出现故障，允许损失一部分功能（也可以是响应时间上的损失）而不影响系统的核心功能。
* 软状态（S）：允许分布式系统的数据存在中间状态，这个状态不影响系统的可用性，也就是允许系统不同节点之间的数据存在同步延时。
* 最终一致性（E）：中间状态经过一定的时间后，会最终达到数据一致。
