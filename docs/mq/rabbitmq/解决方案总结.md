---
title: title
prev:
  text: 回到首页
  link: /README.md
next:
  text: 回到首页
  link: /README.md
---
::: info
文章介绍
:::
[[toc]]

***
# RabbitMQ消息防丢失（消息可靠）

RabbitMQ不建议用事务机制，因为官网写着说开启事务机制会导致吞吐量降低250倍左右。解决方案如下：

* **持久化**
    * **exchange持久化**
    * **queue持久化**
    * **message持久化**
* **生产者消息可靠投递confirm。**
* **消费者签收确认ack**
* **Broker高可用**
# 消息积压

## 产生消息积压的原因及场景

* 消费者宕机
* 消费者消费能力不足
## 解决方案

* 可能的情况下调优消费端限流
* 上线更多的消费者（Working Queue）
* 最次的情况可以上线一部分消费者，将消息取出来存入数据库或者做预处理暂存，后续再慢慢处理
# 防止重复消费

将接口设计为**消息幂等**的接口：

* 消费者使用乐观锁
* Redis锁等

